// ─────────────────────────────────────────────
// EXECUTION & STORAGE
// ─────────────────────────────────────────────

workDir       = "/scratch/$USER/nf-work"
stashDir      = "/scratch/$USER/nf-stash"
publishDirMode = "copy"
cleanup       = false

apptainer {
    enabled   = true
    autoMounts = true
    cacheDir  = "/scratch/$USER/nf-apptainer-cache"
}

// ─────────────────────────────────────────────
// EXECUTORS
// ─────────────────────────────────────────────

executor {
    $slurm {
        queueSize = 300
        submitRateLimit = '10 sec'
        jobName = { "${task.process}_${task.hash}" }
    }
}

process {
    executor = 'slurm'
    errorStrategy = 'retry'
    maxRetries = 3

    clusterOptions = "--partition=general --account=jkg"

    withLabel: 'small' {
        cpus = 1
        memory = 2.GB
        time = '1h'
    }

    withLabel: 'med' {
        cpus = 4
        memory = 8.GB
        time = '2h'
    }

    withLabel: 'large' {
        cpus = 8
        memory = 32.GB
        time = '4h'
    }
}
